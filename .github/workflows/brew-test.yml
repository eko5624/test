name: brew

on:
  workflow_dispatch:
  #schedule:
  #  - cron: '0 0 * * MON'

jobs:
  test:
    runs-on: macos-12
    env:
      HOMEBREW_NO_ANALYTICS: 1
      HOMEBREW_NO_INSTALL_CLEANUP: 1
      HOMEBREW_NO_INSTALLED_DEPENDENTS_CHECK: 1 
    steps:   
    - name: test
      run: |       
        ffmpeg_deps=(
          dav1d
          fontconfig
          freetype
          frei0r
          gnutls
          lame
          libbluray
          libbs2b
          libcaca
          libmodplug
          librist
          libsoxr
          libssh
          libvidstab
          libvorbis
          libvpx
          opencore-amr
          openjpeg
          openssl@3
          opus
          rav1e
          rubberband
          sdl2
          snappy
          speex
          srt
          tesseract
          theora
          webp
          xvid
          xz
          zeromq
          zimg            
        )        
        brew deps -n --union --include-build --include-test $ffmpeg_deps
